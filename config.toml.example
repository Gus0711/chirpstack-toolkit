# LoRaWAN Analyzer Configuration

[mqtt]
# Connect directly to your ChirpStack installation's MQTT broker.
# This is the same broker that ChirpStack Gateway Bridge publishes to.
#
# Examples:
#   Local ChirpStack:    "tcp://localhost:1883"
#   Docker network:      "tcp://chirpstack-mosquitto:1883"  (use the container name)
#   Remote host:         "tcp://chirpstack.example.com:1883"
#
# If running the analyzer in Docker and ChirpStack is on the host:
#   Linux:               "tcp://host.docker.internal:1883" or "tcp://172.17.0.1:1883"
#   macOS/Windows:       "tcp://host.docker.internal:1883"
server = "tcp://host.docker.internal:1883"
username = ""
password = ""

# MQTT topic for gateway uplink events.
# The region prefix (e.g. eu868) must match your ChirpStack Gateway Bridge config.
# Common values: eu868, us915, as923, au915, in865, etc.
topic = "eu868/gateway/+/event/up"

# Message format: "protobuf" (default, ChirpStack v4) or "json" (ChirpStack v3 / JSON marshaler)
format = "protobuf"

# Application-level MQTT integration for device metadata (optional)
# Subscribes to ChirpStack application events to enrich devices with names,
# DevEUI, application name, and device profile. JSON format (ChirpStack v4 default).
# application_topic = "application/+/device/+/event/+"

[clickhouse]
# When using Docker Compose, keep this as-is (uses the service name).
# For native installs, use "http://localhost:8123".
url = "http://clickhouse:8123"
database = "lorawan"

[api]
# For Docker: bind to 0.0.0.0 (container-internal, exposed via docker-compose ports).
# For native: bind to 127.0.0.1:3000 to restrict to localhost.
bind = "0.0.0.0:3000"

# Custom operator mappings (optional, higher priority than built-in LoRa Alliance NetID database)
# Use these to label your own networks or operators not yet in the built-in database.
#
# [[operators]]
# prefix = "26000000/20"       # DevAddr prefix in hex / prefix length in bits
# name = "My Network"
# known_devices = true          # Mark as "my devices" for visibility filtering
# color = "#3b82f6"             # Custom color in the dashboard
#
# Multiple prefixes per operator:
# [[operators]]
# prefix = ["26011234/32", "26015678/32"]
# name = "My Other Network"

# Hide rules - hide traffic matching these prefixes from the dashboard (optional)
# [[hide_rules]]
# type = "dev_addr"
# prefix = "26000000/20"
# description = "Hide my own devices"
#
# [[hide_rules]]
# type = "join_eui"
# prefix = "70B3D57ED0000000/64"
# description = "Hide specific JoinEUI"

# --- ChirpStack API integration for gateway names (optional) ---
# Fetches gateway names from the ChirpStack REST API every 5 minutes.
# Requires an API key from ChirpStack (API Keys section in the web UI).
#
# [chirpstack_api]
# url = "http://chirpstack:8080"
# api_key = "your-api-key-here"

# --- Device Management (management.html) ---
# The management page provides import/export/bulk operations for ChirpStack devices.
# It connects directly to ChirpStack via the built-in proxy (/proxy/*).
# No server-side configuration is needed â€” the ChirpStack URL and API token
# are provided by the user in the browser.
#
# Features:
#   - Import devices from CSV/XLSX files
#   - Export devices to CSV/XLSX
#   - Bulk delete, migrate, change device profile, update tags
#   - Cross-application device search
#   - Import profiles with required tags
#   - Saved ChirpStack server bookmarks (stored in ClickHouse)
#
# Access: http://localhost:15337/management.html

# --- Multiplex MQTT setup (advanced) ---
# If you enabled the bundled mosquitto broker (docker compose --profile multiplex up),
# you can bridge multiple ChirpStack MQTT sources into it and point the analyzer there:
#
# [mqtt]
# server = "tcp://mosquitto:1883"
# username = "analyzer"
# password = "your-password"
# topic = "eu868/gateway/+/event/up"
# format = "protobuf"
